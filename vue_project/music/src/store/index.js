import Vue from "vue";
import Vuex from "vuex";
import modules from "./modules/modules";
import types from './modules/types';


Vue.use(Vuex);

export default new Vuex.Store({
  state: {
    err: null,
    prevPath: "",
    lyricPage: false,
    playing: false,
    showLoading: false,
    currentSong: {
      "id": 1815918804,
      "type": 4,
      "name": "一个人",
      "copywriter": null,
      "picUrl": "http://p1.music.126.net/k7cd8qT7O9zcrUGU8vdSAg==/109951165674250196.jpg",
      "canDislike": true,
      "trackNumberUpdateTime": null,
      "song": {
        "name": "一个人",
        "id": 1815918804,
        "position": 0,
        "alias": [

        ],
        "status": 0,
        "fee": 8,
        "copyrightId": 1418077,
        "disc": "01",
        "no": 1,
        "artists": [
          {
            "name": "王嘉尔",
            "id": 1083118,
            "picId": 0,
            "img1v1Id": 0,
            "briefDesc": "",
            "picUrl": "http://p4.music.126.net/6y-UleORITEDbvrOLV0Q8A==/5639395138885805.jpg",
            "img1v1Url": "http://p4.music.126.net/6y-UleORITEDbvrOLV0Q8A==/5639395138885805.jpg",
            "albumSize": 0,
            "alias": [

            ],
            "trans": "",
            "musicSize": 0,
            "topicPerson": 0
          }
        ],
        "album": {
          "name": "一个人",
          "id": 122299210,
          "type": "Single",
          "size": 0,
          "picId": 109951165674250190,
          "blurPicUrl": "http://p4.music.126.net/k7cd8qT7O9zcrUGU8vdSAg==/109951165674250196.jpg",
          "companyId": 0,
          "pic": 109951165674250190,
          "picUrl": "http://p4.music.126.net/k7cd8qT7O9zcrUGU8vdSAg==/109951165674250196.jpg",
          "publishTime": 1611936000000,
          "description": "",
          "tags": "",
          "company": "RYCE MUSIC GROUP白米范文化传播有限公司",
          "briefDesc": "",
          "artist": {
            "name": "",
            "id": 0,
            "picId": 0,
            "img1v1Id": 0,
            "briefDesc": "",
            "picUrl": "http://p3.music.126.net/6y-UleORITEDbvrOLV0Q8A==/5639395138885805.jpg",
            "img1v1Url": "http://p4.music.126.net/6y-UleORITEDbvrOLV0Q8A==/5639395138885805.jpg",
            "albumSize": 0,
            "alias": [

            ],
            "trans": "",
            "musicSize": 0,
            "topicPerson": 0
          },
          "songs": [

          ],
          "alias": [

          ],
          "status": 0,
          "copyrightId": 1418077,
          "commentThreadId": "R_AL_3_122299210",
          "artists": [
            {
              "name": "王嘉尔",
              "id": 1083118,
              "picId": 0,
              "img1v1Id": 0,
              "briefDesc": "",
              "picUrl": "http://p3.music.126.net/6y-UleORITEDbvrOLV0Q8A==/5639395138885805.jpg",
              "img1v1Url": "http://p3.music.126.net/6y-UleORITEDbvrOLV0Q8A==/5639395138885805.jpg",
              "albumSize": 0,
              "alias": [

              ],
              "trans": "",
              "musicSize": 0,
              "topicPerson": 0
            }
          ],
          "subType": "录音室版",
          "transName": null,
          "onSale": false,
          "mark": 0,
          "picId_str": "109951165674250196"
        },
        "starred": false,
        "popularity": 5,
        "score": 5,
        "starredNum": 0,
        "duration": 185546,
        "playedNum": 0,
        "dayPlays": 0,
        "hearTime": 0,
        "ringtone": "",
        "crbt": null,
        "audition": null,
        "copyFrom": "",
        "commentThreadId": "R_SO_4_1815918804",
        "rtUrl": null,
        "ftype": 0,
        "rtUrls": [

        ],
        "copyright": 0,
        "transName": null,
        "sign": null,
        "mark": 0,
        "originCoverType": 0,
        "originSongSimpleData": null,
        "single": 0,
        "noCopyrightRcmd": null,
        "rtype": 0,
        "rurl": null,
        "mvid": 14242316,
        "bMusic": {
          "name": null,
          "id": 6474559062,
          "size": 2969644,
          "extension": "mp3",
          "sr": 44100,
          "dfsId": 0,
          "bitrate": 128000,
          "playTime": 185546,
          "volumeDelta": -25323
        },
        "mp3Url": null,
        "hMusic": {
          "name": null,
          "id": 6474559058,
          "size": 7424044,
          "extension": "mp3",
          "sr": 44100,
          "dfsId": 0,
          "bitrate": 320000,
          "playTime": 185546,
          "volumeDelta": -29649
        },
        "mMusic": {
          "name": null,
          "id": 6474559060,
          "size": 4454444,
          "extension": "mp3",
          "sr": 44100,
          "dfsId": 0,
          "bitrate": 192000,
          "playTime": 185546,
          "volumeDelta": -27039
        },
        "lMusic": {
          "name": null,
          "id": 6474559062,
          "size": 2969644,
          "extension": "mp3",
          "sr": 44100,
          "dfsId": 0,
          "bitrate": 128000,
          "playTime": 185546,
          "volumeDelta": -25323
        },
        "exclusive": false,
        "privilege": {
          "id": 1815918804,
          "fee": 8,
          "payed": 0,
          "st": 0,
          "pl": 128000,
          "dl": 0,
          "sp": 7,
          "cp": 1,
          "subp": 1,
          "cs": false,
          "maxbr": 999000,
          "fl": 128000,
          "toast": false,
          "flag": 4,
          "preSell": false,
          "playMaxbr": 999000,
          "downloadMaxbr": 999000,
          "freeTrialPrivilege": {
            "resConsumable": false,
            "userConsumable": false
          },
          "chargeInfoList": [
            {
              "rate": 128000,
              "chargeUrl": null,
              "chargeMessage": null,
              "chargeType": 0
            },
            {
              "rate": 192000,
              "chargeUrl": null,
              "chargeMessage": null,
              "chargeType": 1
            },
            {
              "rate": 320000,
              "chargeUrl": null,
              "chargeMessage": null,
              "chargeType": 1
            },
            {
              "rate": 999000,
              "chargeUrl": null,
              "chargeMessage": null,
              "chargeType": 1
            }
          ]
        }
      },
      "alg": "hot_server"
    },
    currentSongList: [],
    currentSongListIndex: -1
  },
  getters: {
    currentSongUrl: state => {
      if (state.currentSong) {
        return `https://music.163.com/song/media/outer/url?id=${state.currentSong.id}.mp3`;
      } else {
        return "https://music.163.com/song/media/outer/url?id=1815692964.mp3"
      }
    },
    currentSongPicUrl: state => {
      if (state.currentSong.picUrl) {
        return state.currentSong.picUrl || "http://p3.music.126.net/5G0jdorNO1vRvJDys7kESw==/109951165669210873.jpg";
      } else if (state.currentSong.al) {
        return state.currentSong.al.picUrl || "http://p3.music.126.net/5G0jdorNO1vRvJDys7kESw==/109951165669210873.jpg";
      } else if (state.currentSong.artists) {
        return state.currentSong.artists.img1v1Url || state.currentSong.artists[0].img1v1Url || "http://p3.music.126.net/5G0jdorNO1vRvJDys7kESw==/109951165669210873.jpg";
      } else {
        return "http://p3.music.126.net/5G0jdorNO1vRvJDys7kESw==/109951165669210873.jpg";
      }
    },


    currentSongArtists: state => {
      if (state.currentSong.song) {
        return state.currentSong.song.artists;
      } else if (state.currentSong.ar) {
        return state.currentSong.ar;
      } else if (state.currentSong.artists) {
        return state.currentSong.artists;
      } else {
        return [];
      }
    },
    currentSongDuration: state => {
      if (state.currentSong.song) {
        return state.currentSong.song.duration;
      } else if (state.currentSong.dt) {
        return state.currentSong.dt;
      } else if (state.currentSong.duration) {
        return state.currentSong.duration;
      } else {
        return 0;
      }
    },
  },
  mutations: {
    [types.UPDATE](state, payload) {
      if (payload.name) {
        state[payload.name][payload.key] = payload.value;
      } else {

        state[payload.key] = payload.value;
      }
    }
  },
  actions: {

    [types.UPDATE]({
      commit
    }, n) {
      commit(types.UPDATE, {
        n
      });
    }
  },
  modules
});